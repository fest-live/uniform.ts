/**
 * Invoker - Requestor/Responder Abstraction
 *
 * Thin wrapper around UnifiedChannel providing:
 * - Requestor: Invokes commands to remote channel objects/methods
 * - Responder: Listens, executes via Reflect, returns proxy-wrapped results
 * - Auto-detection of connection/transport type
 */
import { createUnifiedChannel } from "../channel/UnifiedChannel";
// ============================================================================
// CONTEXT DETECTION
// ============================================================================
export function detectContextType() {
    if (typeof globalThis.Deno !== "undefined")
        return "deno";
    if (typeof globalThis.process !== "undefined" && globalThis.process?.versions?.node)
        return "node";
    if (typeof ServiceWorkerGlobalScope !== "undefined" && self instanceof ServiceWorkerGlobalScope)
        return "service-worker";
    if (typeof SharedWorkerGlobalScope !== "undefined" && self instanceof SharedWorkerGlobalScope)
        return "shared-worker";
    if (typeof DedicatedWorkerGlobalScope !== "undefined" && self instanceof DedicatedWorkerGlobalScope)
        return "worker";
    if (typeof chrome !== "undefined" && chrome.runtime?.id) {
        if (typeof chrome.runtime.getBackgroundPage === "function" || chrome.runtime.getManifest?.()?.background?.service_worker)
            return "chrome-background";
        if (typeof chrome.devtools !== "undefined")
            return "chrome-devtools";
        if (typeof document !== "undefined" && globalThis?.location?.protocol === "chrome-extension:") {
            const views = chrome.extension?.getViews?.({ type: "popup" }) ?? [];
            if (views.includes(globalThis))
                return "chrome-popup";
        }
        if (typeof document !== "undefined" && globalThis?.location?.protocol !== "chrome-extension:")
            return "chrome-content";
    }
    if (typeof globalThis !== "undefined" && typeof document !== "undefined")
        return "window";
    return "unknown";
}
export function detectTransportType(source) {
    if (!source)
        return "internal";
    if (typeof Worker !== "undefined" && source instanceof Worker)
        return "worker";
    if (typeof SharedWorker !== "undefined" && source instanceof SharedWorker)
        return "shared-worker";
    if (typeof MessagePort !== "undefined" && source instanceof MessagePort)
        return "message-port";
    if (typeof BroadcastChannel !== "undefined" && source instanceof BroadcastChannel)
        return "broadcast";
    if (typeof WebSocket !== "undefined" && source instanceof WebSocket)
        return "websocket";
    if (typeof RTCDataChannel !== "undefined" && source instanceof RTCDataChannel)
        return "rtc-data";
    if (source === "chrome-runtime" || source === "chrome-tabs" || source === "chrome-port" || source === "chrome-external") {
        return source;
    }
    if (typeof chrome !== "undefined" &&
        source &&
        typeof source === "object" &&
        typeof source.postMessage === "function" &&
        source.onMessage?.addListener) {
        return "chrome-port";
    }
    if (source === self || source === globalThis || source === "self")
        return "self";
    return "internal";
}
export function detectIncomingContextType(data) {
    if (!data)
        return "unknown";
    if (data.contextType)
        return data.contextType;
    const sender = data.sender ?? "";
    if (sender.includes("worker"))
        return "worker";
    if (sender.includes("sw") || sender.includes("service"))
        return "service-worker";
    if (sender.includes("chrome") || sender.includes("crx"))
        return "chrome-content";
    if (sender.includes("background"))
        return "chrome-background";
    return "unknown";
}
// ============================================================================
// DEFAULT REFLECT
// ============================================================================
export const DefaultReflect = {
    get: (target, prop) => Reflect.get(target, prop),
    set: (target, prop, value) => Reflect.set(target, prop, value),
    has: (target, prop) => Reflect.has(target, prop),
    apply: (target, thisArg, args) => Reflect.apply(target, thisArg, args),
    construct: (target, args) => Reflect.construct(target, args),
    deleteProperty: (target, prop) => Reflect.deleteProperty(target, prop),
    ownKeys: (target) => Reflect.ownKeys(target),
    getOwnPropertyDescriptor: (target, prop) => Reflect.getOwnPropertyDescriptor(target, prop),
    getPrototypeOf: (target) => Reflect.getPrototypeOf(target),
    setPrototypeOf: (target, proto) => Reflect.setPrototypeOf(target, proto),
    isExtensible: (target) => Reflect.isExtensible(target),
    preventExtensions: (target) => Reflect.preventExtensions(target)
};
// ============================================================================
// REQUESTOR (Wrapper around UnifiedChannel for sending)
// ============================================================================
export class Requestor {
    _channel;
    _contextType;
    constructor(config) {
        this._contextType = config.autoDetect !== false ? detectContextType() : "unknown";
        this._channel = createUnifiedChannel({
            name: config.channel,
            timeout: config.timeout,
            autoListen: false
        });
    }
    connect(target, options) {
        this._channel.connect(target, options);
        return this;
    }
    invoke(targetChannel, action, path, args = []) {
        return this._channel.invoke(targetChannel, action, path, args);
    }
    get(targetChannel, path, prop) {
        return this._channel.get(targetChannel, path, prop);
    }
    set(targetChannel, path, prop, value) {
        return this._channel.set(targetChannel, path, prop, value);
    }
    call(targetChannel, path, args = []) {
        return this._channel.call(targetChannel, path, args);
    }
    construct(targetChannel, path, args = []) {
        return this._channel.construct(targetChannel, path, args);
    }
    importModule(targetChannel, url) {
        return this._channel.import(url, targetChannel);
    }
    createProxy(targetChannel, basePath = []) {
        return this._channel.proxy(targetChannel, basePath);
    }
    get onResponse() { return this._channel.onResponse; }
    get contextType() { return this._contextType; }
    close() { this._channel.close(); }
}
// ============================================================================
// RESPONDER (Wrapper around UnifiedChannel for receiving)
// ============================================================================
export class Responder {
    _channel;
    _contextType;
    constructor(config) {
        this._contextType = config.autoDetect !== false ? detectContextType() : "unknown";
        this._channel = createUnifiedChannel({
            name: config.channel,
            timeout: config.timeout,
            autoListen: false
        });
    }
    listen(source, options) {
        this._channel.listen(source, options);
        return this;
    }
    expose(name, obj) {
        this._channel.expose(name, obj);
        return this;
    }
    get onInvocation() { return this._channel.onInvocation; }
    subscribeInvocations(handler) {
        return this._channel.onInvocation.subscribe(handler);
    }
    get contextType() { return this._contextType; }
    close() { this._channel.close(); }
}
// ============================================================================
// BIDIRECTIONAL INVOKER
// ============================================================================
export class BidirectionalInvoker {
    requestor;
    responder;
    _contextType;
    constructor(config) {
        this._contextType = config.autoDetect !== false ? detectContextType() : "unknown";
        this.requestor = new Requestor(config);
        this.responder = new Responder(config);
    }
    connect(target) {
        this.requestor.connect(target);
        this.responder.listen(target);
        return this;
    }
    expose(name, obj) { this.responder.expose(name, obj); return this; }
    createProxy(targetChannel, basePath = []) { return this.requestor.createProxy(targetChannel, basePath); }
    importModule(targetChannel, url) { return this.requestor.importModule(targetChannel, url); }
    get contextType() { return this._contextType; }
    close() { this.requestor.close(); this.responder.close(); }
}
// ============================================================================
// FACTORY FUNCTIONS
// ============================================================================
export function createRequestor(channel, config) {
    return new Requestor({ channel, ...config });
}
export function createResponder(channel, config) {
    return new Responder({ channel, ...config });
}
export function createInvoker(channel, config) {
    return new BidirectionalInvoker({ channel, ...config });
}
export function setupInvoker(channel, target, config) {
    return createInvoker(channel, config).connect(target);
}
export function autoInvoker(channel, config) {
    const invoker = createInvoker(channel, { autoDetect: true, ...config });
    const contextType = detectContextType();
    switch (contextType) {
        case "worker":
        case "service-worker":
        case "shared-worker":
            invoker.connect(self);
            break;
        case "chrome-content":
        case "chrome-background":
        case "chrome-popup":
            invoker.connect("chrome-runtime");
            break;
    }
    return invoker;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiSW52b2tlci5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIkludm9rZXIudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7Ozs7Ozs7R0FPRztBQUdILE9BQU8sRUFBa0Isb0JBQW9CLEVBQWtELE1BQU0sMkJBQTJCLENBQUM7QUE4RGpJLCtFQUErRTtBQUMvRSxvQkFBb0I7QUFDcEIsK0VBQStFO0FBRS9FLE1BQU0sVUFBVSxpQkFBaUI7SUFDN0IsSUFBSSxPQUFRLFVBQWtCLENBQUMsSUFBSSxLQUFLLFdBQVc7UUFBRSxPQUFPLE1BQU0sQ0FBQztJQUNuRSxJQUFJLE9BQVEsVUFBa0IsQ0FBQyxPQUFPLEtBQUssV0FBVyxJQUFLLFVBQWtCLENBQUMsT0FBTyxFQUFFLFFBQVEsRUFBRSxJQUFJO1FBQUUsT0FBTyxNQUFNLENBQUM7SUFDckgsSUFBSSxPQUFPLHdCQUF3QixLQUFLLFdBQVcsSUFBSSxJQUFJLFlBQVksd0JBQXdCO1FBQUUsT0FBTyxnQkFBZ0IsQ0FBQztJQUN6SCxJQUFJLE9BQU8sdUJBQXVCLEtBQUssV0FBVyxJQUFJLElBQUksWUFBWSx1QkFBdUI7UUFBRSxPQUFPLGVBQWUsQ0FBQztJQUN0SCxJQUFJLE9BQU8sMEJBQTBCLEtBQUssV0FBVyxJQUFJLElBQUksWUFBWSwwQkFBMEI7UUFBRSxPQUFPLFFBQVEsQ0FBQztJQUVySCxJQUFJLE9BQU8sTUFBTSxLQUFLLFdBQVcsSUFBSSxNQUFNLENBQUMsT0FBTyxFQUFFLEVBQUUsRUFBRSxDQUFDO1FBQ3RELElBQUksT0FBTyxNQUFNLENBQUMsT0FBTyxDQUFDLGlCQUFpQixLQUFLLFVBQVUsSUFBSyxNQUFNLENBQUMsT0FBTyxDQUFDLFdBQVcsRUFBRSxFQUFFLEVBQUUsVUFBa0IsRUFBRSxjQUFjO1lBQUUsT0FBTyxtQkFBbUIsQ0FBQztRQUM5SixJQUFJLE9BQVEsTUFBYyxDQUFDLFFBQVEsS0FBSyxXQUFXO1lBQUUsT0FBTyxpQkFBaUIsQ0FBQztRQUM5RSxJQUFJLE9BQU8s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LEVBQUUsQ0FBQyxDQUFDO0lBQ3hFLE1BQU0sV0FBVyxHQUFHLGlCQUFpQixFQUFFLENBQUM7SUFFeEMsUUFBUSxXQUFXLEVBQUUsQ0FBQztRQUNsQixLQUFLLFFBQVEsQ0FBQztRQUNkLEtBQUssZ0JBQWdCLENBQUM7UUFDdEIsS0FBSyxlQUFlO1lBQ2hCLE9BQU8sQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLENBQUM7WUFDdEIsTUFBTTtRQUNWLEtBQUssZ0JBQWdCLENBQUM7UUFDdEIsS0FBSyxtQkFBbUIsQ0FBQztRQUN6QixLQUFLLGNBQWM7WUFDZixPQUFPLENBQUMsT0FBTyxDQUFDLGdCQUF1QixDQUFDLENBQUM7WUFDekMsTUFBTTtJQUNkLENBQUM7SUFFRCxPQUFPLE9BQU8sQ0FBQztBQUNuQixDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBJbnZva2VyIC0gUmVxdWVzdG9yL1Jlc3BvbmRlciBBYnN0cmFjdGlvblxuICpcbiAqIFRoaW4gd3JhcHBlciBhcm91bmQgVW5pZmllZENoYW5uZWwgcHJvdmlkaW5nOlxuICogLSBSZXF1ZXN0b3I6IEludm9rZXMgY29tbWFuZHMgdG8gcmVtb3RlIGNoYW5uZWwgb2JqZWN0cy9tZXRob2RzXG4gKiAtIFJlc3BvbmRlcjogTGlzdGVucywgZXhlY3V0ZXMgdmlhIFJlZmxlY3QsIHJldHVybnMgcHJveHktd3JhcHBlZCByZXN1bHRzXG4gKiAtIEF1dG8tZGV0ZWN0aW9uIG9mIGNvbm5lY3Rpb24vdHJhbnNwb3J0IHR5cGVcbiAqL1xuXG5pbXBvcnQgeyBVVUlEdjQgfSBmcm9tIFwiZmVzdC9jb3JlXCI7XG5pbXBvcnQgeyBVbmlmaWVkQ2hhbm5lbCwgY3JlYXRlVW5pZmllZENoYW5uZWwsIHR5cGUgVW5pZmllZENoYW5uZWxDb25maWcsIHR5cGUgQ29ubmVjdE9wdGlvbnMgfSBmcm9tIFwiLi4vY2hhbm5lbC9VbmlmaWVkQ2hhbm5lbFwiO1xuaW1wb3J0IHR5cGUgeyBTdWJzY3JpcHRpb24sIENoYW5uZWxNZXNzYWdlIH0gZnJvbSBcIi4uL29ic2VydmFibGUvT2JzZXJ2YWJsZVwiO1xuaW1wb3J0IHsgV1JlZmxlY3RBY3Rpb24sIHR5cGUgV1JlZmxlY3REZXNjcmlwdG9yLCB0eXBlIFRyYW5zcG9ydFR5cGUgfSBmcm9tIFwiLi4vdHlwZXMvSW50ZXJmYWNlXCI7XG5cbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbi8vIFRZUEVTXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5cbi8qKiBEZXRlY3RlZCBjb250ZXh0IHR5cGUgKi9cbmV4cG9ydCB0eXBlIENvbnRleHRUeXBlID1cbiAgICB8IFwid2luZG93XCIgfCBcIndvcmtlclwiIHwgXCJzaGFyZWQtd29ya2VyXCIgfCBcInNlcnZpY2Utd29ya2VyXCJcbiAgICB8IFwiY2hyb21lLWNvbnRlbnRcIiB8IFwiY2hyb21lLWJhY2tncm91bmRcIiB8IFwiY2hyb21lLXBvcHVwXCIgfCBcImNocm9tZS1kZXZ0b29sc1wiXG4gICAgfCBcIm5vZGVcIiB8IFwiZGVub1wiIHwgXCJ1bmtub3duXCI7XG5cbi8qKiBJbnZva2VyIGNvbmZpZ3VyYXRpb24gKi9cbmV4cG9ydCBpbnRlcmZhY2UgSW52b2tlckNvbmZpZyB7XG4gICAgY2hhbm5lbDogc3RyaW5nO1xuICAgIGF1dG9EZXRlY3Q/OiBib29sZWFuO1xuICAgIHRpbWVvdXQ/OiBudW1iZXI7XG4gICAgY2FjaGVSZXNwb25zZXM/OiBib29sZWFuO1xuICAgIHJlZmxlY3RJbXBsPzogUmVmbGVjdExpa2U7XG59XG5cbi8qKiBSZWZsZWN0TGlrZSBpbnRlcmZhY2UgKi9cbmV4cG9ydCBpbnRlcmZhY2UgUmVmbGVjdExpa2Uge1xuICAgIGdldD8odGFyZ2V0OiBhbnksIHByb3A6IFByb3BlcnR5S2V5KTogYW55O1xuICAgIHNldD8odGFyZ2V0OiBhbnksIHByb3A6IFByb3BlcnR5S2V5LCB2YWx1ZTogYW55KTogYm9vbGVhbjtcbiAgICBoYXM/KHRhcmdldDogYW55LCBwcm9wOiBQcm9wZXJ0eUtleSk6IGJvb2xlYW47XG4gICAgYXBwbHk/KHRhcmdldDogYW55LCB0aGlzQXJnOiBhbnksIGFyZ3M6IGFueVtdKTogYW55O1xuICAgIGNvbnN0cnVjdD8odGFyZ2V0OiBhbnksIGFyZ3M6IGFueVtdKTogYW55O1xuICAgIGRlbGV0ZVByb3BlcnR5Pyh0YXJnZXQ6IGFueSwgcHJvcDogUHJvcGVydHlLZXkpOiBib29sZWFuO1xuICAgIG93bktleXM/KHRhcmdldDogYW55KTogKHN0cmluZyB8IHN5bWJvbClbXTtcbiAgICBnZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3I/KHRhcmdldDogYW55LCBwcm9wOiBQcm9wZXJ0eUtleSk6IFByb3BlcnR5RGVzY3JpcHRvciB8IHVuZGVmaW5lZDtcbiAgICBnZXRQcm90b3R5cGVPZj8odGFyZ2V0OiBhbnkpOiBvYmplY3QgfCBudWxsO1xuICAgIHNldFByb3RvdHlwZU9mPyh0YXJnZXQ6IGFueSwgcHJvdG86IG9iamVjdCB8IG51bGwpOiBib29sZWFuO1xuICAgIGlzRXh0ZW5zaWJsZT8odGFyZ2V0OiBhbnkpOiBib29sZWFuO1xuICAgIHByZXZlbnRFeHRlbnNpb25zPyh0YXJnZXQ6IGFueSk6IGJvb2xlYW47XG59XG5cbi8qKiBJbmNvbWluZyBpbnZvY2F0aW9uIGV2ZW50ICovXG5leHBvcnQgaW50ZXJmYWNlIEluY29taW5nSW52b2NhdGlvbiB7XG4gICAgaWQ6IHN0cmluZztcbiAgICBjaGFubmVsOiBzdHJpbmc7XG4gICAgc2VuZGVyOiBzdHJpbmc7XG4gICAgYWN0aW9uOiBXUmVmbGVjdEFjdGlvbiB8IHN0cmluZztcbiAgICBwYXRoOiBzdHJpbmdbXTtcbiAgICBhcmdzOiBhbnlbXTtcbiAgICB0aW1lc3RhbXA6IG51bWJlcjtcbiAgICBjb250ZXh0VHlwZT86IENvbnRleHRUeXBlO1xufVxuXG4vKiogT3V0Z29pbmcgcmVzcG9uc2UgKi9cbmV4cG9ydCBpbnRlcmZhY2UgSW52b2NhdGlvblJlc3BvbnNlIHtcbiAgICBpZDogc3RyaW5nO1xuICAgIGNoYW5uZWw6IHN0cmluZztcbiAgICBzZW5kZXI6IHN0cmluZztcbiAgICByZXN1bHQ6IGFueTtcbiAgICBkZXNjcmlwdG9yPzogV1JlZmxlY3REZXNjcmlwdG9yO1xuICAgIGVycm9yPzogc3RyaW5nO1xuICAgIHRpbWVzdGFtcDogbnVtYmVyO1xufVxuXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4vLyBDT05URVhUIERFVEVDVElPTlxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG5leHBvcnQgZnVuY3Rpb24gZGV0ZWN0Q29udGV4dFR5cGUoKTogQ29udGV4dFR5cGUge1xuICAgIGlmICh0eXBlb2YgKGdsb2JhbFRoaXMgYXMgYW55KS5EZW5vICE9PSBcInVuZGVmaW5lZFwiKSByZXR1cm4gXCJkZW5vXCI7XG4gICAgaWYgKHR5cGVvZiAoZ2xvYmFsVGhpcyBhcyBhbnkpLnByb2Nlc3MgIT09IFwidW5kZWZpbmVkXCIgJiYgKGdsb2JhbFRoaXMgYXMgYW55KS5wcm9jZXNzPy52ZXJzaW9ucz8ubm9kZSkgcmV0dXJuIFwibm9kZVwiO1xuICAgIGlmICh0eXBlb2YgU2VydmljZVdvcmtlckdsb2JhbFNjb3BlICE9PSBcInVuZGVmaW5lZFwiICYmIHNlbGYgaW5zdGFuY2VvZiBTZXJ2aWNlV29ya2VyR2xvYmFsU2NvcGUpIHJldHVybiBcInNlcnZpY2Utd29ya2VyXCI7XG4gICAgaWYgKHR5cGVvZiBTaGFyZWRXb3JrZXJHbG9iYWxTY29wZSAhPT0gXCJ1bmRlZmluZWRcIiAmJiBzZWxmIGluc3RhbmNlb2YgU2hhcmVkV29ya2VyR2xvYmFsU2NvcGUpIHJldHVybiBcInNoYXJlZC13b3JrZXJcIjtcbiAgICBpZiAodHlwZW9mIERlZGljYXRlZFdvcmtlckdsb2JhbFNjb3BlICE9PSBcInVuZGVmaW5lZFwiICYmIHNlbGYgaW5zdGFuY2VvZiBEZWRpY2F0ZWRXb3JrZXJHbG9iYWxTY29wZSkgcmV0dXJuIFwid29ya2VyXCI7XG5cbiAgICBpZiAodHlwZW9mIGNocm9tZSAhPT0gXCJ1bmRlZmluZWRcIiAmJiBjaHJvbWUucnVudGltZT8uaWQpIHtcbiAgICAgICAgaWYgKHR5cGVvZiBjaHJvbWUucnVudGltZS5nZXRCYWNrZ3JvdW5kUGFnZSA9PT0gXCJmdW5jdGlvblwiIHx8IChjaHJvbWUucnVudGltZS5nZXRNYW5pZmVzdD8uKCk/LmJhY2tncm91bmQgYXMgYW55KT8uc2VydmljZV93b3JrZXIpIHJldHVybiBcImNocm9tZS1iYWNrZ3JvdW5kXCI7XG4gICAgICAgIGlmICh0eXBlb2YgKGNocm9tZSBhcyBhbnkpLmRldnRvb2xzICE9PSBcInVuZGVmaW5lZFwiKSByZXR1cm4gXCJjaHJvbWUtZGV2dG9vbHNcIjtcbiAgICAgICAgaWYgKHR5cGVvZiBkb2N1bWVudCAhPT0gXCJ1bmRlZmluZWRcIiAmJiBnbG9iYWxUaGlzPy5sb2NhdGlvbj8ucHJvdG9jb2wgPT09IFwiY2hyb21lLWV4dGVuc2lvbjpcIikge1xuICAgICAgICAgICAgY29uc3Qgdmlld3MgPSBjaHJvbWUuZXh0ZW5zaW9uPy5nZXRWaWV3cz8uKHsgdHlwZTogXCJwb3B1cFwiIH0pID8/IFtdO1xuICAgICAgICAgICAgaWYgKHZpZXdzLmluY2x1ZGVzKGdsb2JhbFRoaXMgYXMgYW55KSkgcmV0dXJuIFwiY2hyb21lLXBvcHVwXCI7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHR5cGVvZiBkb2N1bWVudCAhPT0gXCJ1bmRlZmluZWRcIiAmJiBnbG9iYWxUaGlzPy5sb2NhdGlvbj8ucHJvdG9jb2wgIT09IFwiY2hyb21lLWV4dGVuc2lvbjpcIikgcmV0dXJuIFwiY2hyb21lLWNvbnRlbnRcIjtcbiAgICB9XG5cbiAgICBpZiAodHlwZW9mIGdsb2JhbFRoaXMgIT09IFwidW5kZWZpbmVkXCIgJiYgdHlwZW9mIGRvY3VtZW50ICE9PSBcInVuZGVmaW5lZFwiKSByZXR1cm4gXCJ3aW5kb3dcIjtcbiAgICByZXR1cm4gXCJ1bmtub3duXCI7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBkZXRlY3RUcmFuc3BvcnRUeXBlKHNvdXJjZTogV29ya2VyIHwgTWVzc2FnZVBvcnQgfCBCcm9hZGNhc3RDaGFubmVsIHwgV2ViU29ja2V0IHwgYW55KTogVHJhbnNwb3J0VHlwZSB7XG4gICAgaWYgKCFzb3VyY2UpIHJldHVybiBcImludGVybmFsXCI7XG4gICAgaWYgKHR5cGVvZiBXb3JrZXIgIT09IFwidW5kZWZpbmVkXCIgJiYgc291cmNlIGluc3RhbmNlb2YgV29ya2VyKSByZXR1cm4gXCJ3b3JrZXJcIjtcbiAgICBpZiAodHlwZW9mIFNoYXJlZFdvcmtlciAhPT0gXCJ1bmRlZmluZWRcIiAmJiBzb3VyY2UgaW5zdGFuY2VvZiBTaGFyZWRXb3JrZXIpIHJldHVybiBcInNoYXJlZC13b3JrZXJcIjtcbiAgICBpZiAodHlwZW9mIE1lc3NhZ2VQb3J0ICE9PSBcInVuZGVmaW5lZFwiICYmIHNvdXJjZSBpbnN0YW5jZW9mIE1lc3NhZ2VQb3J0KSByZXR1cm4gXCJtZXNzYWdlLXBvcnRcIjtcbiAgICBpZiAodHlwZW9mIEJyb2FkY2FzdENoYW5uZWwgIT09IFwidW5kZWZpbmVkXCIgJiYgc291cmNlIGluc3RhbmNlb2YgQnJvYWRjYXN0Q2hhbm5lbCkgcmV0dXJuIFwiYnJvYWRjYXN0XCI7XG4gICAgaWYgKHR5cGVvZiBXZWJTb2NrZXQgIT09IFwidW5kZWZpbmVkXCIgJiYgc291cmNlIGluc3RhbmNlb2YgV2ViU29ja2V0KSByZXR1cm4gXCJ3ZWJzb2NrZXRcIjtcbiAgICBpZiAodHlwZW9mIFJUQ0RhdGFDaGFubmVsICE9PSBcInVuZGVmaW5lZFwiICYmIHNvdXJjZSBpbnN0YW5jZW9mIFJUQ0RhdGFDaGFubmVsKSByZXR1cm4gXCJydGMtZGF0YVwiO1xuICAgIGlmIChzb3VyY2UgPT09IFwiY2hyb21lLXJ1bnRpbWVcIiB8fCBzb3VyY2UgPT09IFwiY2hyb21lLXRhYnNcIiB8fCBzb3VyY2UgPT09IFwiY2hyb21lLXBvcnRcIiB8fCBzb3VyY2UgPT09IFwiY2hyb21lLWV4dGVybmFsXCIpIHtcbiAgICAgICAgcmV0dXJuIHNvdXJjZSBhcyBUcmFuc3BvcnRUeXBlO1xuICAgIH1cbiAgICBpZiAoXG4gICAgICAgIHR5cGVvZiBjaHJvbWUgIT09IFwidW5kZWZpbmVkXCIgJiZcbiAgICAgICAgc291cmNlICYmXG4gICAgICAgIHR5cGVvZiBzb3VyY2UgPT09IFwib2JqZWN0XCIgJiZcbiAgICAgICAgdHlwZW9mIHNvdXJjZS5wb3N0TWVzc2FnZSA9PT0gXCJmdW5jdGlvblwiICYmXG4gICAgICAgIHNvdXJjZS5vbk1lc3NhZ2U/LmFkZExpc3RlbmVyXG4gICAgKSB7XG4gICAgICAgIHJldHVybiBcImNocm9tZS1wb3J0XCI7XG4gICAgfVxuICAgIGlmIChzb3VyY2UgPT09IHNlbGYgfHwgc291cmNlID09PSBnbG9iYWxUaGlzIHx8IHNvdXJjZSA9PT0gXCJzZWxmXCIpIHJldHVybiBcInNlbGZcIjtcbiAgICByZXR1cm4gXCJpbnRlcm5hbFwiO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZGV0ZWN0SW5jb21pbmdDb250ZXh0VHlwZShkYXRhOiBhbnkpOiBDb250ZXh0VHlwZSB7XG4gICAgaWYgKCFkYXRhKSByZXR1cm4gXCJ1bmtub3duXCI7XG4gICAgaWYgKGRhdGEuY29udGV4dFR5cGUpIHJldHVybiBkYXRhLmNvbnRleHRUeXBlO1xuICAgIGNvbnN0IHNlbmRlciA9IGRhdGEuc2VuZGVyID8/IFwiXCI7XG4gICAgaWYgKHNlbmRlci5pbmNsdWRlcyhcIndvcmtlclwiKSkgcmV0dXJuIFwid29ya2VyXCI7XG4gICAgaWYgKHNlbmRlci5pbmNsdWRlcyhcInN3XCIpIHx8IHNlbmRlci5pbmNsdWRlcyhcInNlcnZpY2VcIikpIHJldHVybiBcInNlcnZpY2Utd29ya2VyXCI7XG4gICAgaWYgKHNlbmRlci5pbmNsdWRlcyhcImNocm9tZVwiKSB8fCBzZW5kZXIuaW5jbHVkZXMoXCJjcnhcIikpIHJldHVybiBcImNocm9tZS1jb250ZW50XCI7XG4gICAgaWYgKHNlbmRlci5pbmNsdWRlcyhcImJhY2tncm91bmRcIikpIHJldHVybiBcImNocm9tZS1iYWNrZ3JvdW5kXCI7XG4gICAgcmV0dXJuIFwidW5rbm93blwiO1xufVxuXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4vLyBERUZBVUxUIFJFRkxFQ1Rcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuZXhwb3J0IGNvbnN0IERlZmF1bHRSZWZsZWN0OiBSZWZsZWN0TGlrZSA9IHtcbiAgICBnZXQ6ICh0YXJnZXQsIHByb3ApID0+IFJlZmxlY3QuZ2V0KHRhcmdldCwgcHJvcCksXG4gICAgc2V0OiAodGFyZ2V0LCBwcm9wLCB2YWx1ZSkgPT4gUmVmbGVjdC5zZXQodGFyZ2V0LCBwcm9wLCB2YWx1ZSksXG4gICAgaGFzOiAodGFyZ2V0LCBwcm9wKSA9PiBSZWZsZWN0Lmhhcyh0YXJnZXQsIHByb3ApLFxuICAgIGFwcGx5OiAodGFyZ2V0LCB0aGlzQXJnLCBhcmdzKSA9PiBSZWZsZWN0LmFwcGx5KHRhcmdldCwgdGhpc0FyZywgYXJncyksXG4gICAgY29uc3RydWN0OiAodGFyZ2V0LCBhcmdzKSA9PiBSZWZsZWN0LmNvbnN0cnVjdCh0YXJnZXQsIGFyZ3MpLFxuICAgIGRlbGV0ZVByb3BlcnR5OiAodGFyZ2V0LCBwcm9wKSA9PiBSZWZsZWN0LmRlbGV0ZVByb3BlcnR5KHRhcmdldCwgcHJvcCksXG4gICAgb3duS2V5czogKHRhcmdldCkgPT4gUmVmbGVjdC5vd25LZXlzKHRhcmdldCkgYXMgKHN0cmluZyB8IHN5bWJvbClbXSxcbiAgICBnZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3I6ICh0YXJnZXQsIHByb3ApID0+IFJlZmxlY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKHRhcmdldCwgcHJvcCksXG4gICAgZ2V0UHJvdG90eXBlT2Y6ICh0YXJnZXQpID0+IFJlZmxlY3QuZ2V0UHJvdG90eXBlT2YodGFyZ2V0KSxcbiAgICBzZXRQcm90b3R5cGVPZjogKHRhcmdldCwgcHJvdG8pID0+IFJlZmxlY3Quc2V0UHJvdG90eXBlT2YodGFyZ2V0LCBwcm90byksXG4gICAgaXNFeHRlbnNpYmxlOiAodGFyZ2V0KSA9PiBSZWZsZWN0LmlzRXh0ZW5zaWJsZSh0YXJnZXQpLFxuICAgIHByZXZlbnRFeHRlbnNpb25zOiAodGFyZ2V0KSA9PiBSZWZsZWN0LnByZXZlbnRFeHRlbnNpb25zKHRhcmdldClcbn07XG5cbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbi8vIFJFUVVFU1RPUiAoV3JhcHBlciBhcm91bmQgVW5pZmllZENoYW5uZWwgZm9yIHNlbmRpbmcpXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5cbmV4cG9ydCBjbGFzcyBSZXF1ZXN0b3Ige1xuICAgIHByaXZhdGUgX2NoYW5uZWw6IFVuaWZpZWRDaGFubmVsO1xuICAgIHByaXZhdGUgX2NvbnRleHRUeXBlOiBDb250ZXh0VHlwZTtcblxuICAgIGNvbnN0cnVjdG9yKGNvbmZpZzogSW52b2tlckNvbmZpZykge1xuICAgICAgICB0aGlzLl9jb250ZXh0VHlwZSA9IGNvbmZpZy5hdXRvRGV0ZWN0ICE9PSBmYWxzZSA/IGRldGVjdENvbnRleHRUeXBlKCkgOiBcInVua25vd25cIjtcbiAgICAgICAgdGhpcy5fY2hhbm5lbCA9IGNyZWF0ZVVuaWZpZWRDaGFubmVsKHtcbiAgICAgICAgICAgIG5hbWU6IGNvbmZpZy5jaGFubmVsLFxuICAgICAgICAgICAgdGltZW91dDogY29uZmlnLnRpbWVvdXQsXG4gICAgICAgICAgICBhdXRvTGlzdGVuOiBmYWxzZVxuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBjb25uZWN0KHRhcmdldDogV29ya2VyIHwgTWVzc2FnZVBvcnQgfCBCcm9hZGNhc3RDaGFubmVsIHwgV2ViU29ja2V0IHwgYW55LCBvcHRpb25zPzogQ29ubmVjdE9wdGlvbnMpOiB0aGlzIHtcbiAgICAgICAgdGhpcy5fY2hhbm5lbC5jb25uZWN0KHRhcmdldCwgb3B0aW9ucyk7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cblxuICAgIGludm9rZTxUID0gYW55Pih0YXJnZXRDaGFubmVsOiBzdHJpbmcsIGFjdGlvbjogV1JlZmxlY3RBY3Rpb24sIHBhdGg6IHN0cmluZ1tdLCBhcmdzOiBhbnlbXSA9IFtdKTogUHJvbWlzZTxUPiB7XG4gICAgICAgIHJldHVybiB0aGlzLl9jaGFubmVsLmludm9rZSh0YXJnZXRDaGFubmVsLCBhY3Rpb24sIHBhdGgsIGFyZ3MpO1xuICAgIH1cblxuICAgIGdldDxUID0gYW55Pih0YXJnZXRDaGFubmVsOiBzdHJpbmcsIHBhdGg6IHN0cmluZ1tdLCBwcm9wOiBzdHJpbmcpOiBQcm9taXNlPFQ+IHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2NoYW5uZWwuZ2V0KHRhcmdldENoYW5uZWwsIHBhdGgsIHByb3ApO1xuICAgIH1cblxuICAgIHNldCh0YXJnZXRDaGFubmVsOiBzdHJpbmcsIHBhdGg6IHN0cmluZ1tdLCBwcm9wOiBzdHJpbmcsIHZhbHVlOiBhbnkpOiBQcm9taXNlPGJvb2xlYW4+IHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2NoYW5uZWwuc2V0KHRhcmdldENoYW5uZWwsIHBhdGgsIHByb3AsIHZhbHVlKTtcbiAgICB9XG5cbiAgICBjYWxsPFQgPSBhbnk+KHRhcmdldENoYW5uZWw6IHN0cmluZywgcGF0aDogc3RyaW5nW10sIGFyZ3M6IGFueVtdID0gW10pOiBQcm9taXNlPFQ+IHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2NoYW5uZWwuY2FsbCh0YXJnZXRDaGFubmVsLCBwYXRoLCBhcmdzKTtcbiAgICB9XG5cbiAgICBjb25zdHJ1Y3Q8VCA9IGFueT4odGFyZ2V0Q2hhbm5lbDogc3RyaW5nLCBwYXRoOiBzdHJpbmdbXSwgYXJnczogYW55W10gPSBbXSk6IFByb21pc2U8VD4ge1xuICAgICAgICByZXR1cm4gdGhpcy5fY2hhbm5lbC5jb25zdHJ1Y3QodGFyZ2V0Q2hhbm5lbCwgcGF0aCwgYXJncyk7XG4gICAgfVxuXG4gICAgaW1wb3J0TW9kdWxlPFQgPSBhbnk+KHRhcmdldENoYW5uZWw6IHN0cmluZywgdXJsOiBzdHJpbmcpOiBQcm9taXNlPFQ+IHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2NoYW5uZWwuaW1wb3J0KHVybCwgdGFyZ2V0Q2hhbm5lbCk7XG4gICAgfVxuXG4gICAgY3JlYXRlUHJveHk8VCA9IGFueT4odGFyZ2V0Q2hhbm5lbDogc3RyaW5nLCBiYXNlUGF0aDogc3RyaW5nW10gPSBbXSk6IFQge1xuICAgICAgICByZXR1cm4gdGhpcy5fY2hhbm5lbC5wcm94eSh0YXJnZXRDaGFubmVsLCBiYXNlUGF0aCk7XG4gICAgfVxuXG4gICAgZ2V0IG9uUmVzcG9uc2UoKSB7IHJldHVybiB0aGlzLl9jaGFubmVsLm9uUmVzcG9uc2U7IH1cbiAgICBnZXQgY29udGV4dFR5cGUoKTogQ29udGV4dFR5cGUgeyByZXR1cm4gdGhpcy5fY29udGV4dFR5cGU7IH1cbiAgICBjbG9zZSgpOiB2b2lkIHsgdGhpcy5fY2hhbm5lbC5jbG9zZSgpOyB9XG59XG5cbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbi8vIFJFU1BPTkRFUiAoV3JhcHBlciBhcm91bmQgVW5pZmllZENoYW5uZWwgZm9yIHJlY2VpdmluZylcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuZXhwb3J0IGNsYXNzIFJlc3BvbmRlciB7XG4gICAgcHJpdmF0ZSBfY2hhbm5lbDogVW5pZmllZENoYW5uZWw7XG4gICAgcHJpdmF0ZSBfY29udGV4dFR5cGU6IENvbnRleHRUeXBlO1xuXG4gICAgY29uc3RydWN0b3IoY29uZmlnOiBJbnZva2VyQ29uZmlnKSB7XG4gICAgICAgIHRoaXMuX2NvbnRleHRUeXBlID0gY29uZmlnLmF1dG9EZXRlY3QgIT09IGZhbHNlID8gZGV0ZWN0Q29udGV4dFR5cGUoKSA6IFwidW5rbm93blwiO1xuICAgICAgICB0aGlzLl9jaGFubmVsID0gY3JlYXRlVW5pZmllZENoYW5uZWwoe1xuICAgICAgICAgICAgbmFtZTogY29uZmlnLmNoYW5uZWwsXG4gICAgICAgICAgICB0aW1lb3V0OiBjb25maWcudGltZW91dCxcbiAgICAgICAgICAgIGF1dG9MaXN0ZW46IGZhbHNlXG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIGxpc3Rlbihzb3VyY2U6IFdvcmtlciB8IE1lc3NhZ2VQb3J0IHwgQnJvYWRjYXN0Q2hhbm5lbCB8IFdlYlNvY2tldCB8IGFueSwgb3B0aW9ucz86IENvbm5lY3RPcHRpb25zKTogdGhpcyB7XG4gICAgICAgIHRoaXMuX2NoYW5uZWwubGlzdGVuKHNvdXJjZSwgb3B0aW9ucyk7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cblxuICAgIGV4cG9zZShuYW1lOiBzdHJpbmcsIG9iajogYW55KTogdGhpcyB7XG4gICAgICAgIHRoaXMuX2NoYW5uZWwuZXhwb3NlKG5hbWUsIG9iaik7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cblxuICAgIGdldCBvbkludm9jYXRpb24oKSB7IHJldHVybiB0aGlzLl9jaGFubmVsLm9uSW52b2NhdGlvbjsgfVxuICAgIHN1YnNjcmliZUludm9jYXRpb25zKGhhbmRsZXI6IChpbnY6IEluY29taW5nSW52b2NhdGlvbikgPT4gdm9pZCk6IFN1YnNjcmlwdGlvbiB7XG4gICAgICAgIHJldHVybiB0aGlzLl9jaGFubmVsLm9uSW52b2NhdGlvbi5zdWJzY3JpYmUoaGFuZGxlciBhcyBhbnkpO1xuICAgIH1cbiAgICBnZXQgY29udGV4dFR5cGUoKTogQ29udGV4dFR5cGUgeyByZXR1cm4gdGhpcy5fY29udGV4dFR5cGU7IH1cbiAgICBjbG9zZSgpOiB2b2lkIHsgdGhpcy5fY2hhbm5lbC5jbG9zZSgpOyB9XG59XG5cbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbi8vIEJJRElSRUNUSU9OQUwgSU5WT0tFUlxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG5leHBvcnQgY2xhc3MgQmlkaXJlY3Rpb25hbEludm9rZXIge1xuICAgIHB1YmxpYyByZWFkb25seSByZXF1ZXN0b3I6IFJlcXVlc3RvcjtcbiAgICBwdWJsaWMgcmVhZG9ubHkgcmVzcG9uZGVyOiBSZXNwb25kZXI7XG4gICAgcHJpdmF0ZSBfY29udGV4dFR5cGU6IENvbnRleHRUeXBlO1xuXG4gICAgY29uc3RydWN0b3IoY29uZmlnOiBJbnZva2VyQ29uZmlnKSB7XG4gICAgICAgIHRoaXMuX2NvbnRleHRUeXBlID0gY29uZmlnLmF1dG9EZXRlY3QgIT09IGZhbHNlID8gZGV0ZWN0Q29udGV4dFR5cGUoKSA6IFwidW5rbm93blwiO1xuICAgICAgICB0aGlzLnJlcXVlc3RvciA9IG5ldyBSZXF1ZXN0b3IoY29uZmlnKTtcbiAgICAgICAgdGhpcy5yZXNwb25kZXIgPSBuZXcgUmVzcG9uZGVyKGNvbmZpZyk7XG4gICAgfVxuXG4gICAgY29ubmVjdCh0YXJnZXQ6IFdvcmtlciB8IE1lc3NhZ2VQb3J0IHwgQnJvYWRjYXN0Q2hhbm5lbCB8IFdlYlNvY2tldCB8IGFueSk6IHRoaXMge1xuICAgICAgICB0aGlzLnJlcXVlc3Rvci5jb25uZWN0KHRhcmdldCk7XG4gICAgICAgIHRoaXMucmVzcG9uZGVyLmxpc3Rlbih0YXJnZXQpO1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9XG5cbiAgICBleHBvc2UobmFtZTogc3RyaW5nLCBvYmo6IGFueSk6IHRoaXMgeyB0aGlzLnJlc3BvbmRlci5leHBvc2UobmFtZSwgb2JqKTsgcmV0dXJuIHRoaXM7IH1cbiAgICBjcmVhdGVQcm94eTxUID0gYW55Pih0YXJnZXRDaGFubmVsOiBzdHJpbmcsIGJhc2VQYXRoOiBzdHJpbmdbXSA9IFtdKTogVCB7IHJldHVybiB0aGlzLnJlcXVlc3Rvci5jcmVhdGVQcm94eSh0YXJnZXRDaGFubmVsLCBiYXNlUGF0aCk7IH1cbiAgICBpbXBvcnRNb2R1bGU8VCA9IGFueT4odGFyZ2V0Q2hhbm5lbDogc3RyaW5nLCB1cmw6IHN0cmluZyk6IFByb21pc2U8VD4geyByZXR1cm4gdGhpcy5yZXF1ZXN0b3IuaW1wb3J0TW9kdWxlKHRhcmdldENoYW5uZWwsIHVybCk7IH1cbiAgICBnZXQgY29udGV4dFR5cGUoKTogQ29udGV4dFR5cGUgeyByZXR1cm4gdGhpcy5fY29udGV4dFR5cGU7IH1cbiAgICBjbG9zZSgpOiB2b2lkIHsgdGhpcy5yZXF1ZXN0b3IuY2xvc2UoKTsgdGhpcy5yZXNwb25kZXIuY2xvc2UoKTsgfVxufVxuXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4vLyBGQUNUT1JZIEZVTkNUSU9OU1xuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlUmVxdWVzdG9yKGNoYW5uZWw6IHN0cmluZywgY29uZmlnPzogUGFydGlhbDxJbnZva2VyQ29uZmlnPik6IFJlcXVlc3RvciB7XG4gICAgcmV0dXJuIG5ldyBSZXF1ZXN0b3IoeyBjaGFubmVsLCAuLi5jb25maWcgfSk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVSZXNwb25kZXIoY2hhbm5lbDogc3RyaW5nLCBjb25maWc/OiBQYXJ0aWFsPEludm9rZXJDb25maWc+KTogUmVzcG9uZGVyIHtcbiAgICByZXR1cm4gbmV3IFJlc3BvbmRlcih7IGNoYW5uZWwsIC4uLmNvbmZpZyB9KTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZUludm9rZXIoY2hhbm5lbDogc3RyaW5nLCBjb25maWc/OiBQYXJ0aWFsPEludm9rZXJDb25maWc+KTogQmlkaXJlY3Rpb25hbEludm9rZXIge1xuICAgIHJldHVybiBuZXcgQmlkaXJlY3Rpb25hbEludm9rZXIoeyBjaGFubmVsLCAuLi5jb25maWcgfSk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBzZXR1cEludm9rZXIoXG4gICAgY2hhbm5lbDogc3RyaW5nLFxuICAgIHRhcmdldDogV29ya2VyIHwgTWVzc2FnZVBvcnQgfCBCcm9hZGNhc3RDaGFubmVsIHwgV2ViU29ja2V0IHwgYW55LFxuICAgIGNvbmZpZz86IFBhcnRpYWw8SW52b2tlckNvbmZpZz5cbik6IEJpZGlyZWN0aW9uYWxJbnZva2VyIHtcbiAgICByZXR1cm4gY3JlYXRlSW52b2tlcihjaGFubmVsLCBjb25maWcpLmNvbm5lY3QodGFyZ2V0KTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGF1dG9JbnZva2VyKGNoYW5uZWw6IHN0cmluZywgY29uZmlnPzogUGFydGlhbDxJbnZva2VyQ29uZmlnPik6IEJpZGlyZWN0aW9uYWxJbnZva2VyIHtcbiAgICBjb25zdCBpbnZva2VyID0gY3JlYXRlSW52b2tlcihjaGFubmVsLCB7IGF1dG9EZXRlY3Q6IHRydWUsIC4uLmNvbmZpZyB9KTtcbiAgICBjb25zdCBjb250ZXh0VHlwZSA9IGRldGVjdENvbnRleHRUeXBlKCk7XG5cbiAgICBzd2l0Y2ggKGNvbnRleHRUeXBlKSB7XG4gICAgICAgIGNhc2UgXCJ3b3JrZXJcIjpcbiAgICAgICAgY2FzZSBcInNlcnZpY2Utd29ya2VyXCI6XG4gICAgICAgIGNhc2UgXCJzaGFyZWQtd29ya2VyXCI6XG4gICAgICAgICAgICBpbnZva2VyLmNvbm5lY3Qoc2VsZik7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSBcImNocm9tZS1jb250ZW50XCI6XG4gICAgICAgIGNhc2UgXCJjaHJvbWUtYmFja2dyb3VuZFwiOlxuICAgICAgICBjYXNlIFwiY2hyb21lLXBvcHVwXCI6XG4gICAgICAgICAgICBpbnZva2VyLmNvbm5lY3QoXCJjaHJvbWUtcnVudGltZVwiIGFzIGFueSk7XG4gICAgICAgICAgICBicmVhaztcbiAgICB9XG5cbiAgICByZXR1cm4gaW52b2tlcjtcbn1cbiJdfQ==